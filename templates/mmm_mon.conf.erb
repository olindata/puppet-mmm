###########################################################
# PUPPET MANAGED                                          #
# Do not edit this file on a server node unless you       #
# are willing to have your changes overwritten by         #
# Puppet.  If you really want to change the contents      #
# repository and check it out on the puppet server.       #
###########################################################
<%
  multi_cluster_monitor = scope.lookupvar('mmm::params::multi_cluster_monitor')
  h_cluster_name        = multi_cluster_monitor ? "_#{@cluster_name}" : ''
-%>

include mmm_common<%= h_cluster_name %>.conf

<monitor>
  ip              <%= @monitor_ip %>
  pid_path        <%= @mmm::params::pid_path %>
  bin_path        <%= @mmm::params::bin_path %>
  status_path     <%= @mmm::params::status_path %>
<%
  ips = [];

  masters.each { |master| ips << master["ip"] }
  slaves.each { |slave| ips << slave["ip"] }
-%>
  ping_ips        <%= ips.join(', ') %>
  auto_set_online 60
<% if cluster_name != '' -%>
  port          <%= @port %>
<% end -%>
</monitor>

<host default>
  monitor_user        <%= @monitor_user %>
  monitor_password    <%= @monitor_password %>
</host>

debug 0
